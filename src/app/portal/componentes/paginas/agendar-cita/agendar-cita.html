<div class="container mt-4">
  <h1 class="h2 mb-4">Agendar una Nueva Cita</h1>
  
  <div class="card shadow-sm">
    <div class="card-body">
      <form [formGroup]="formularioCita" (ngSubmit)="agendarCita()">
        
        <div class="mb-3">
          <label for="medico" class="form-label">Especialista</label>
          <select id="medico" class="form-select" formControlName="medicoId">
            <option value="" disabled>Seleccione un médico...</option>
            <option *ngFor="let medico of medicos()" [value]="medico.id">
              Dr(a). {{ medico.nombres }} {{ medico.apellidos }} ({{ medico.especialidad }})
            </option>
          </select>
          <div *ngIf="formularioCita.get('medicoId')?.touched && formularioCita.get('medicoId')?.invalid" class="text-danger mt-1">
            <small>Debe seleccionar un médico.</small>
          </div>
        </div>

        <div class="mb-3">
          <label for="fechaHora" class="form-label">Fecha y Hora</label>
          <input type="datetime-local" id="fechaHora" class="form-control" formControlName="fechaHora">
          <div *ngIf="formularioCita.get('fechaHora')?.touched && formularioCita.get('fechaHora')?.invalid" class="text-danger mt-1">
            <small>Debe seleccionar una fecha y hora.</small>
          </div>
        </div>

        <div class="mb-3">
          <label for="motivo" class="form-label">Motivo de la Cita</label>
          <textarea id="motivo" class="form-control" formControlName="motivo" rows="4" placeholder="Describa brevemente el motivo de su visita..."></textarea>
          <div *ngIf="formularioCita.get('motivo')?.touched && formularioCita.get('motivo')?.invalid" class="text-danger mt-1">
            <small>El motivo es requerido.</small>
          </div>
        </div>

        <div *ngIf="error()" class="alert alert-danger">
          {{ error() }}
        </div>

        <div class="d-flex justify-content-end">
          <button type="button" class="btn btn-secondary me-2" [routerLink]="['/portal/mis-citas']">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="cargando()">
            <span *ngIf="!cargando()">Agendar Cita</span>
            <app-spinner *ngIf="cargando()"></app-spinner>
          </button>
        </div>

      </form>
    </div>
  </div>
</div>